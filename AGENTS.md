# Repository Guidelines

## Project Structure & Module Organization
- `src/` houses the TypeScript sources: `gepa.ts` exposes the GEPA optimizer, `strategies.ts` and `pareto-utils.ts` contain selection logic, and `adapters/` holds LLM adapters such as `default-adapter.ts`.
- `persistence.ts` implements file-based checkpoints; enable it via `GEPAOptions.persistence` to resume runs.
- `examples/` provides runnable workflows (`email-extraction.ts`, `message-spam.ts`) that double as integration smoke tests.
- `dist/` is generated by the TypeScript compiler; never edit files there—rebuild instead.
- Configuration lives in `tsconfig.json` (strict mode, `src` as `rootDir`) and `package.json` scripts.

## Build, Test, and Development Commands
- `npm install` installs runtime deps (`ai`, `tokenlens`) plus dev tooling.
- `npm run build` compiles TypeScript into `dist/` with declaration maps for downstream packages.
- `npm run dev` runs `tsc --watch` for incremental rebuilds while you iterate on `src/`.
- `npm run type-check` enforces strict typing without emitting files—use it before committing large refactors.
- `npm run test` executes the Vitest suite once; pair with `npm run test:watch` during active development.
- `npm run example` or `npm run example:message-spam` run the sample optimizations through `tsx`.
- `npm run clean` clears `dist/` to ensure fresh builds.

## Coding Style & Naming Conventions
- Stick to TypeScript `strict` expectations; favor explicit return types, `const` bindings, and discriminated unions for candidate state.
- Existing modules use two-space indentation, `camelCase` for functions/variables, `PascalCase` for classes and exported types, and `UPPER_SNAKE` only for true constants.
- Keep public APIs re-exported through `src/index.ts` so consumers access them from `@currentai/dsts`.
- Leverage Zod schemas for adapter IO contracts; align schema names with the associated model (`TaskResultSchema`, etc.).

## Testing Guidelines
- Use Vitest with ESM-style imports; place specs under `tests/` or alongside modules as `*.test.ts` so they stay outside the build output.
- Mirror module names (`gepa.test.ts`) and cover the Pareto helpers plus persistence flows to guard against regressions.
- Run `npm run test` and `npm run type-check` before opening a PR; add scenario coverage for new strategies or adapters.

## Commit & Pull Request Guidelines
- Follow Conventional Commit prefixes observed in history (`feat`, `chore`, `fix`, optional scopes) and write imperative, present-tense subjects under 72 characters.
- Group related changes per commit; include relevant context (e.g., "feat: add hypervolume fallback for sparse fronts").
- PRs should summarize behavior changes, link tracking issues, list test commands executed, and attach logs or sample outputs when touching adapters/examples.
- Ensure the branch is rebased on `main`, CI is green, and CHANGELOG updates accompany user-facing changes.
